{% extends "base.html" %}

{% block title %}
Homepage
{% endblock %}
{% block stylesheet %}
  <link rel="stylesheet" type= "text/css"href="{{ url_for('static',filename='styles/homepage.css') }}">
{% endblock %}
{%block navcontents%}
{% if user == 'null' %}
  <li class="nav-item m-2">
    <form method="GET" action="/login">
      <button class="btn btn-outline-dark" type="submit">Login</button>
    </form>
  </li>
{% else %}
  <li class="nav-item m-2">
    <form method="GET" action="/logout">
      <button class="btn btn-outline-dark" type="submit">Log Out</button>
    </form>
  </li>
{% endif %}
<li class="nav-item m-2">
  <form method="GET" action="/favorites">
    <button class="btn btn-outline-dark" type="submit">Favorite Pokemon</button>
  </form>
</li>
{% endblock %}
{% block body %}

<div class="containter bg-danger rounded mx-5 p-2">
  <br><br>
  <div class="container-fluid m-2 p-2"
       <div class="container">

	 <!-- Here lies the sort form -->
	 <form method="GET" action="/" id="sorts">
	   <button type="submit">Sort</button>
	   <select name="sort" id="sort" form="sorts">
	     <option value="default">Sort by...</option>
	     <option value="gen1">Gen 1 (Kanto)</option>
	     <option value="gen2">Gen 2 (Johto)</option>
	     <option value="gen3">Gen 3 (Hoenn)</option>
	     <option value="gen4">Gen 4 (Sinnoh)</option>
	     <option value="gen5">Gen 5 (Unova)</option>
	     <option value="gen6">Gen 6 (Kalos)</option>
	     <option value="gen7">Gen 7 (Alola)</option>
	     <option value="normal">Normal</option>
	     <option value="fighting">Fighting</option>
	     <option value="flying">Flying</option>
	     <option value="poison">Poison</option>
	     <option value="ground">Ground</option>
	     <option value="rock">Rock</option>
	     <option value="bug">Bug</option>
	     <option value="ghost">Ghost</option>
	     <option value="steel">Steel</option>
	     <option value="fire">Fire</option>
	     <option value="water">Water</option>
	     <option value="grass">Grass</option>
	     <option value="electric">Electric</option>
	     <option value="psychic">Psychic</option>
	     <option value="ice">Ice</option>
	     <option value="dragon">Dragon</option>
	     <option value="fairy">Fairy</option>
	     <option value="dark">Dark</option>
	   </select>
	 </form>
	 <br><br>
	 
	 <form method="GET" action="/add" id="f">
           <input type="number" name="pokemon_id" style="display: none;"/>
           <div id="dex" class="dex"></div>
           <br>
	 </form>
       </div>
       <div class="d-flex justify-content-center">
	 <button class="btn btn-primary" id="add">Load More Pokemon</button>
       </div>
</div>


<style>

  .dex {
      display: grid;
      grid-template-columns: repeat(5, 1fr);
      grid-gap: 10px;
  }

</style>

<script>
  new WOW().init();
</script>

<script>

  var pokemon = {{ pokemon | safe }}
  var t = pokemon.length-1;
  var display = function(e) {
      var d = document.getElementById("dex");
      var p = t - 19;
      while (t >= p) {
	  var mons = document.createElement("DIV");
	  var name = document.createElement("P");
	  var image = document.createElement("IMG");
	  var types = document.createElement("P");
	  var button = document.createElement("BUTTON");
	  var br = document.createElement("BR");
	  var ps = document.createElement("P");
	  n = pokemon[t][0];
	  id = pokemon[t][1];
	  i = pokemon[t][2];
	  ty = pokemon[t][3];
	  //console.log(ty.split(' '));
	  image.setAttribute("value",id);
	  image.setAttribute("src", i);
	  /*
	  image.setAttribute("onclick", "return false;");
	  image.setAttribute("ondblclick", "return false;");
	  image.ondblclick = function() {
	      //var input = document.createElement("INPUT");
	      var form = document.createElement("FORM");
	      var input = document.createElement("INPUT");
	      //console.log(this.getAttribute("value"));
	      input.setAttribute("type","number");
	      input.setAttribute("id","yee");
	      input.setAttribute("value", this.getAttribute("value"));
	      this.appendChild(input);
	      //image.appendChild(input);
	      //document.getElementById("f").appendChild(input);
	      //document.getElementById("f").submit();
	      form.setAttribute("action","/add");
	      form.setAttribute("method","POST");
	      //console.log(this);
	      form.appendChild(this);
	      document.getElementById("f").submit();
	      //return this.getAttribute("value");
	  };
*/
	  //mons.setAttribute("style", "display: grid;");
	  name.innerHTML = n + "   #" +  id;
	  types.innerHTML = ty;
	  button.innerHTML = "Add to Favorites";
	  button.setAttribute("value",id);
	  button.setAttribute("class", "btn btn-outline-success")
	  mons.appendChild(name);
	  mons.appendChild(image);
	  mons.appendChild(br);

	  len = ty.split(' ').length-1;
	  k = 0;
	  ts = ty.split(' ');
	  while (k < len) {
	      var badge = document.createElement("SPAN");
	      badge.setAttribute("class","badge badge-pill badge-success");
	      badge.innerHTML = ts[k];
	      k++;
	      mons.appendChild(badge);
	  };

	  mons.appendChild(ps);
	  mons.appendChild(button);
	  t = t - 1;
	  button.onclick = function() {
	      var form = document.getElementById("f");
	      var pid = form.elements['pokemon_id'];
	      form.addEventListener('submit', (event) => {
		  //console.log(this.getAttribute("value"));
		  pid.value = this.getAttribute("value");
	      });
	      button.disabled = true;
	  };
	  d.appendChild(mons);

      }
  };


  var addmons = function(e) {
      var d = document.getElementById("dex");
      var next = document.createElement("UL");
      var p = t - 19;
      while (t >= p) {
	  var mons = document.createElement("DIV");
	  var name = document.createElement("P");
	  var image = document.createElement("IMG");
	  var types = document.createElement("P");
	  var button = document.createElement("BUTTON");
	  var br = document.createElement("BR");
	  n = pokemon[t][0];
	  id = pokemon[t][1]
	  i = pokemon[t][2];
	  ty = pokemon[t][3];
	  image.setAttribute("value",id);
	  image.setAttribute("src", i);
	  name.innerHTML = n + "   #" +  id;
	  button.innerHTML = "Add to Favorites";
	  button.setAttribute("value",id);
	  button.setAttribute("class", "btn btn-outline-success")
	  mons.appendChild(name);
	  mons.appendChild(image);
	  mons.appendChild(br);

	  len = ty.split(' ').length-1;
	  k = 0;
	  ts = ty.split(' ');
	  while (k < len) {
	      var badge = document.createElement("SPAN");
	      badge.setAttribute("class","badge badge-pill badge-success");
	      badge.innerHTML = ts[k];
	      k++;
	      mons.appendChild(badge);
	  };

	  mons.appendChild(br);
	  mons.appendChild(button);
	  t = t - 1;
	  button.onclick = function() {
	      var form = document.getElementById("f");
	      var pid = form.elements['pokemon_id'];
	      form.addEventListener('submit', (event) => {
		  //console.log(this.getAttribute("value"));
		  pid.value = this.getAttribute("value");
	      });
	      button.disabled = true;
	  };
	  d.appendChild(mons);
      }
  }

  display()

  var addbutton = document.getElementById("add");
  addbutton.addEventListener('click', addmons);

</script>

{% endblock %}
